# 詳細ドロワーが「閉じる時だけ少し待ってから閉じる」理由

現象の主因は、Markdown編集中に「ドキュメントの mousedown で外側クリック判定して即保存（saveMarkdown）」しているためです。  
閉じるボタン（▼/▲）をクリックしたとき、次の順序でイベントが走ります:

1) document の mousedown リスナーが最初に発火し saveMarkdown が走る（オーバーレイ表示・更新中フラグなどの状態更新が先に入る）  
2) その後に React の onClick が発火し expanded のトグルが実行される

この順序により、閉じるアニメーションの開始が「保存処理に伴う状態更新やオーバーレイ描画」によって視覚的に遅れたように見えます。

対応:
- ドキュメントの外側クリック検知を mousedown から click に変更（React onClick の後に実行されるため、閉じるアニメーションが即始まる）
- ドロワー内を data-markdown-container でマーキングし、ドロワー内部クリックでは「外側」と判定しないようにする

これにより、閉じる操作時にアニメーションが即時に開始されるようになります。
